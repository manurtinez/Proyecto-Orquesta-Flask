{%extends "base.html"%}
{%block title%}Listado{%endblock title%}
{%block head%}
{{super()}}
{%endblock head%}
{%block content%}

<body >
    <div>
        <form action="{{ url_for('buscarUsuario')}}" method="POST">
            <input type="text" id="buscarUser" style="width: 300px; height: 30px;" name="nombre"
                placeholder="buscar usuario">
            <input class="btn btn-primary" type="submit" value="Buscar">
            <a class="btn btn-primary" href="{{url_for('mostrarInactivos')}}">Mostrar inactivos</a>
            <a class="btn btn-primary" href="{{url_for('mostrarActivos')}}">Mostrar activos</a>
        </form>
        <table class="table">
            <thead>
            <tr>
                <th>Nombre</th>
                <th>Apellido</th>
                <th>Nombre de usuario</th>
                <th>Activo?</th>
                <th>Opciones</th>
            </tr>
            </thead>
            <tbody>
            {% for user in lista %}
            <tr>
                <td>{{user.first_name}}</td>
                <td>{{user.last_name}}</td>
                <td>{{user.username}}</td>
                <td>
                    {% if user.activo == 1 %}
                    Si
                    {% else %}
                    No
                    {% endif %}
                </td>
                <td>
                    <nav>
                        <a href="{{ url_for('showUser', id=user.id)}}" class="btn btn-info">Mostrar</a>
                        {% if admin %}
                        <a href="{{url_for('actualizarUser', id=user.id)}}" class="btn btn-info">Actualizar</a>
                        <a href="{{url_for('eliminarUser')}}" class="btn btn-info">Eliminar</a>
                        {% if user.activo == 1 %}
                        <a href="{{ url_for('bloquearUser', id=user.id) }}" class="btn btn-info">Bloquear</a>
                        {% else %}
                        <a href="{{ url_for('activarUser', id=user.id) }}" class="btn btn-info">Activar</a>
                        {% endif %}
                        {% endif %}
                    </nav>
                </td>
            </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
    <script>
        function myFunction() {
            var input, filter, table, tr, td, i, txtValue;
            input = document.getElementById("buscarUser");
            filter = input.value.toUpperCase();
            table = document.getElementById("listadoUsuarios");
            tr = table.getElementsByTagName("tr");
            for (i = 0; i < tr.length; i++) {
                td = tr[i].getElementsByTagName("td")[0];
                if (td) {
                    txtValue = td.textContent || td.innerText;
                    if (txtValue.toUpperCase().indexOf(filter) > -1) {
                        tr[i].style.display = "";
                    } else {
                        tr[i].style.display = "none";
                    }
                }
            }
        }
    </script>
    <script>
        $(document).ready(function () {
            $('form').on('submit', function (event) {
                $.ajax({
                    data: {
                        busqueda: $('#buscarUser').val()
                    },
                    type: 'POST',
                    url: '/buscar'
                })
                    .done(function (data) {
                        if (data.users) {

                        }
                    }
                    )
            }
            )
        })
    </script>
</body>
{%endblock content%}